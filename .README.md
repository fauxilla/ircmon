## ${pkg.name}

${badge('github-issues')} ${badge('github-stars')} ${badge('github-forks')}

${pkg.description}

like autodl_irssi, but:

-   written with node
-   extensible
-   no irssi dependency
-   add torrent to deluge

Take a look at the awesome [annotated code](https://fauxilla.github.io/ircmon/lib/index.js.html)

## download & run binaries (not available yet)

This is convenient because you don't need to install nodejs & npm.

-   go to [release page](https://github.com/fauxilla/ircmon/releases) & download binary
-   copy `config.sample.hjson` from this repo to `config.hjson` in the same
    directory as your binary and configure paths
    [hjson reference](http://hjson.org/)

## clone repo & run from source

-   be awesome
-   install nodejs & npm
-   clone this repo somewhere like `/opt/`
-   copy `config.sample.hjson` to `config.hjson` and configure paths
    [hjson reference](http://hjson.org/)
-   `npm i` to install all the things
-   `npm run babel` to transpile code
-   start with `npm start`

## clone repo & build your own binaries (not available yet)

-   clone this repo
-   `npm i` to get dependencies
-   `npm run babel` to transpile to node 9
-   `npm run pkg-linux` or `npm run pkg-win`
-   binary will be output to `bin/`

## run from cli

**debug info**

If you run from source and initiate with `npm start` debug info will be written to the console. When running from binaries, you'd need to set a `DEBUG` environment variable to `undisco*` In linux, this is achieved with a command like `DEBUG=undisco* ./ircmon-linux-x64`.

**command line args**

Run with no params to see usage info.

If you're running from source the commands look like `npm start -- watch -l info`

## run as a service (linux) (not available yet)

## run as a service (windows)

no idea how to do this sorry.. help wanted.

## scripts

${scripts()}

## API

<!-- Generated by documentation.js. Update this documentation by updating the source code. -->

#### Table of Contents

-   [CheckError](#checkerror)
-   [deluge](#deluge)
-   [deluge](#deluge-1)
-   [check](#check)
-   [options](#options)
-   [loadDatabase](#loaddatabase)
-   [blackHole](#blackhole)
-   [blackHole](#blackhole-1)
-   [Connection](#connection)
-   [Connection](#connection-1)
    -   [join](#join)
-   [levels](#levels)
    -   [10](#10)
    -   [20](#20)
    -   [30](#30)
    -   [40](#40)
    -   [50](#50)
    -   [60](#60)
-   [loadSite](#loadsite)
-   [loadSite](#loadsite-1)
-   [listDirs](#listdirs)
-   [find](#find)
-   [upsert](#upsert)
-   [Listener](#listener)
-   [Listener](#listener-1)
    -   [init](#init)
-   [init](#init-1)
    -   [getLog](#getlog)
-   [getLog](#getlog-1)
    -   [parse](#parse)
-   [parse](#parse-1)
    -   [handler](#handler)
-   [handler](#handler-1)
    -   [downloadTorrent](#downloadtorrent)
-   [downloadTorrent](#downloadtorrent-1)
-   [usage](#usage)
-   [log](#log)

### CheckError

[lib/Err.js:1-6](https://github.com/fauxilla/ircmon/blob/7c3c6fd1aab8be911e3f923bf08cb7497f04e8a8/lib/Err.js#L1-L6 "Source code on GitHub")

**Extends Error**

**Parameters**

-   `code`  
-   `message`  

### deluge

[lib/downloaders/deluge.js:3-43](https://github.com/fauxilla/ircmon/blob/7c3c6fd1aab8be911e3f923bf08cb7497f04e8a8/lib/downloaders/deluge.js#L3-L43 "Source code on GitHub")

**Parameters**

-   `torrent`  

### deluge

[lib/downloaders/deluge.js:3-43](https://github.com/fauxilla/ircmon/blob/7c3c6fd1aab8be911e3f923bf08cb7497f04e8a8/lib/downloaders/deluge.js#L3-L43 "Source code on GitHub")

**Parameters**

-   `torrent`  

### check

[lib/check.js:4-16](https://github.com/fauxilla/ircmon/blob/7c3c6fd1aab8be911e3f923bf08cb7497f04e8a8/lib/check.js#L4-L16 "Source code on GitHub")

**Parameters**

-   `args` **...any** 

### options

[lib/options.js:8-50](https://github.com/fauxilla/ircmon/blob/7c3c6fd1aab8be911e3f923bf08cb7497f04e8a8/lib/options.js#L8-L50 "Source code on GitHub")

### loadDatabase

[lib/db.js:10-15](https://github.com/fauxilla/ircmon/blob/7c3c6fd1aab8be911e3f923bf08cb7497f04e8a8/lib/db.js#L10-L15 "Source code on GitHub")

**Parameters**

-   `path`   (optional, default `'.store'`)

### blackHole

[lib/downloaders/blackHole.js:12-36](https://github.com/fauxilla/ircmon/blob/7c3c6fd1aab8be911e3f923bf08cb7497f04e8a8/lib/downloaders/blackHole.js#L12-L36 "Source code on GitHub")

**Parameters**

-   `torrent`  

### blackHole

[lib/downloaders/blackHole.js:12-36](https://github.com/fauxilla/ircmon/blob/7c3c6fd1aab8be911e3f923bf08cb7497f04e8a8/lib/downloaders/blackHole.js#L12-L36 "Source code on GitHub")

**Parameters**

-   `torrent`  

### Connection

[lib/Connection.js:13-37](https://github.com/fauxilla/ircmon/blob/7c3c6fd1aab8be911e3f923bf08cb7497f04e8a8/lib/Connection.js#L13-L37 "Source code on GitHub")

**Extends irc.Client**

### Connection

wrapper for irc.Client, ensures only one instance per host/nick

Type: [Connection](#connection)

**Parameters**

-   `network`  
-   `host`  
-   `port`  
-   `nick`  

#### join

[lib/Connection.js:28-36](https://github.com/fauxilla/ircmon/blob/7c3c6fd1aab8be911e3f923bf08cb7497f04e8a8/lib/Connection.js#L28-L36 "Source code on GitHub")

**Parameters**

-   `channels`  

### levels

[lib/log.js:16-23](https://github.com/fauxilla/ircmon/blob/7c3c6fd1aab8be911e3f923bf08cb7497f04e8a8/lib/log.js#L16-L23 "Source code on GitHub")

#### 10

[lib/log.js:22-22](https://github.com/fauxilla/ircmon/blob/7c3c6fd1aab8be911e3f923bf08cb7497f04e8a8/lib/log.js#L22-L22 "Source code on GitHub")

#### 20

[lib/log.js:21-21](https://github.com/fauxilla/ircmon/blob/7c3c6fd1aab8be911e3f923bf08cb7497f04e8a8/lib/log.js#L21-L21 "Source code on GitHub")

#### 30

[lib/log.js:20-20](https://github.com/fauxilla/ircmon/blob/7c3c6fd1aab8be911e3f923bf08cb7497f04e8a8/lib/log.js#L20-L20 "Source code on GitHub")

#### 40

[lib/log.js:19-19](https://github.com/fauxilla/ircmon/blob/7c3c6fd1aab8be911e3f923bf08cb7497f04e8a8/lib/log.js#L19-L19 "Source code on GitHub")

#### 50

[lib/log.js:18-18](https://github.com/fauxilla/ircmon/blob/7c3c6fd1aab8be911e3f923bf08cb7497f04e8a8/lib/log.js#L18-L18 "Source code on GitHub")

#### 60

[lib/log.js:17-17](https://github.com/fauxilla/ircmon/blob/7c3c6fd1aab8be911e3f923bf08cb7497f04e8a8/lib/log.js#L17-L17 "Source code on GitHub")

### loadSite

[lib/loadSite.js:17-31](https://github.com/fauxilla/ircmon/blob/7c3c6fd1aab8be911e3f923bf08cb7497f04e8a8/lib/loadSite.js#L17-L31 "Source code on GitHub")

### loadSite

**Parameters**

-   `site` **[String](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** sitename

Returns **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** site definition

### listDirs

[lib/listDirs.js:17-31](https://github.com/fauxilla/ircmon/blob/7c3c6fd1aab8be911e3f923bf08cb7497f04e8a8/lib/listDirs.js#L17-L31 "Source code on GitHub")

simple dir traversal
collects full paths to directories
depth = 1 will list directories in path, not recursive

**Parameters**

-   `path`  
-   `depth`   (optional, default `1`)
-   `root` **[String](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** 
-   `options` **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** 

Returns **[Array](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array)** files

### find

[lib/db.js:18-23](https://github.com/fauxilla/ircmon/blob/7c3c6fd1aab8be911e3f923bf08cb7497f04e8a8/lib/db.js#L18-L23 "Source code on GitHub")

**Parameters**

-   `descriptor`  

### upsert

[lib/db.js:24-26](https://github.com/fauxilla/ircmon/blob/7c3c6fd1aab8be911e3f923bf08cb7497f04e8a8/lib/db.js#L24-L26 "Source code on GitHub")

**Parameters**

-   `descriptor`  
-   `listener`  

### Listener

[lib/Listener.js:35-239](https://github.com/fauxilla/ircmon/blob/7c3c6fd1aab8be911e3f923bf08cb7497f04e8a8/lib/Listener.js#L35-L239 "Source code on GitHub")

### Listener

Listener class responsible for creating irc connection, monitoring it,
and handling matched files.

Type: [Listener](#listener)

**Parameters**

-   `listener`  
-   `opt`  

#### init

[lib/Listener.js:69-89](https://github.com/fauxilla/ircmon/blob/7c3c6fd1aab8be911e3f923bf08cb7497f04e8a8/lib/Listener.js#L69-L89 "Source code on GitHub")

### init

async initialisation. must be called.

Returns **[Promise](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Promise)** resolves when initialised

#### getLog

[lib/Listener.js:101-112](https://github.com/fauxilla/ircmon/blob/7c3c6fd1aab8be911e3f923bf08cb7497f04e8a8/lib/Listener.js#L101-L112 "Source code on GitHub")

### getLog

creates bound log functions with descriptor.
allos usage like:

    const { debug } = this.log
    debug('hello')

Returns **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** plain object with log level methods

#### parse

[lib/Listener.js:122-157](https://github.com/fauxilla/ircmon/blob/7c3c6fd1aab8be911e3f923bf08cb7497f04e8a8/lib/Listener.js#L122-L157 "Source code on GitHub")

### parse

parse message according to placeholders in site definition, as well as
season / ep if appropriate

**Parameters**

-   `message` **[String](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** irc message, stripped
-   `from` **[String](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** username of message author

Returns **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** map of resolved placeholders

#### handler

[lib/Listener.js:170-210](https://github.com/fauxilla/ircmon/blob/7c3c6fd1aab8be911e3f923bf08cb7497f04e8a8/lib/Listener.js#L170-L210 "Source code on GitHub")

### handler

attached to message listener.

-   parse message
-   checks
-   download torrent

**Parameters**

-   `from` **[String](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** username of author
-   `to` **[String](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** unused
-   `message` **[String](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** message, stripped

Returns **[Promise](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Promise)** resolves on completion

#### downloadTorrent

[lib/Listener.js:217-237](https://github.com/fauxilla/ircmon/blob/7c3c6fd1aab8be911e3f923bf08cb7497f04e8a8/lib/Listener.js#L217-L237 "Source code on GitHub")

### downloadTorrent

**Parameters**

-   `torrent` **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** from parse fn

Returns **[Promise](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Promise)** 

### usage

[lib/options.js:52-109](https://github.com/fauxilla/ircmon/blob/7c3c6fd1aab8be911e3f923bf08cb7497f04e8a8/lib/options.js#L52-L109 "Source code on GitHub")

### log

[lib/log.js:62-75](https://github.com/fauxilla/ircmon/blob/7c3c6fd1aab8be911e3f923bf08cb7497f04e8a8/lib/log.js#L62-L75 "Source code on GitHub")

## developing / testing / contributing

Suggestions / contributions are absolutely welcome.

Use `npm run babel` or `npm run babel:watch` to transpile source from `lib` to
`dist`, then `npm start` to run.

test with `npm run test` or `npm run test:watch`

If you want to contribute anonymously, take a look at [gitmask](https://www.gitmask.com/), you basically upload your commit to gitmask and it destroys your id before making a PR.
